from kivy.app import App
from kivy.uix.button import Button
#лойаут
from kivy.uix.gridlayout import GridLayout
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.widget import Widget
from kivy.uix.label import Label

from kivy.config import Config

class TableBradisApp(App):

    def update_label(self):
        self.lbl.text = self.formula

    #проверка операции, которую выбрали

    def choose_operation(self, instance):
        if self.formula != 0:
            self.formula = ''
        self.formula += str(instance.text)
        self.check_operation()


    def clear_before_func(self):
        self.formula == '0'
        self.update_label()
        self.add_number()


    #проверка на то, какую операцию выбрали
    def check_operation(self):
        global func

        if self.formula == "SIN ":
            func = "sin"
            self.formula == '0'
            self.update_label()

        elif self.formula == "COS ":
            func = "cos"
            self.formula == '0'
            self.update_label()
        print(func)


    #добавление чисел/цифр на табло

    def add_number(self, instance):


        self.formula += str(instance.text)
        self.update_label()


        print(self.formula)

    #удаление всей строки сразу

    def del_all(self, instance):
        if self.formula != '':
            self.formula = ''
        self.update_label()

    #удаление последнего символа

    def del_last_symbol(self, instance):
        self.formula = self.formula[:-1]
        self.update_label()


    def Table_res(self, instance):

        #значения косинуса и синуса

        sin = {"0": 0, "1": 0.017452, "2": 0.034899, "3": 0.052336, "4": 0.069756, "5": 0.087156, "6": 0.104528,
               "7": 0.121869,
               "8": 0.139173, "9": 0.156434, "10": 0.173648, "11": 0.190809, "12": 0.207912, "13": 0.224951,
               "14": 0.241922,
               "15": 0.258819, "16": 0.275637, "17": 0.292372, "18": 0.309017, "19": 0.325568, "20": 0.34202,
               "21": 0.358368,
               "22": 0.374607, "23": 0.390731, "24": 0.406737, "25": 0.422618, "26": 0.438371, "27": 0.45399,
               "28": 0.469472,
               "29": 0.48481, "30": 0.5, "31": 0.515038, "32": 0.529919, "33": 544639, "34": 0.559193, "35": 0.573576,
               "36": 0.587785, "37": 0.601815, "38": 0.615661, "39": 0.62932, "40": 0.642788, "41": 0.656059,
               "42": 0.669131,
               "43": 0.681998, "44": 0.694658, "45": 0.707107, "46": 0.71934, "47": 0.731354, "48": 0.743145,
               "49": 0.75471,
               "50": 0.766044, "51": 0.777146, "52": 0.788011, "53": 0.798636, "54": 0.809017, "55": 0.819152,
               "56": 0.829038,
               "57": 0.838671, "58": 0.848048, "59": 0.857167, "60": 0.866025, "61": 0.87462, "62": 0.882948,
               "63": 0.891007,
               "64": 0.898794, "65": 0.906308, "66": 0.913545, "67": 0.920505, "68": 0.927184, "69": 0.93358,
               "70": 0.939693,
               "71": 0.945519, "72": 0.951057, "73": 0.956305, "74": 0.961262, "75": 0.965926, "76": 0.970296,
               "77": 0.97437,
               "78": 0.978148, "79": 0.981627, "80": 0.984808, "81": 0.987688, "82": 0.990268, "83": 0.992546,
               "84": 0.994522,
               "85": 0.996195, "86": 0.997564, "87": 0.99863, "88": 0.999391, "89": 0.999848, "90": 1, "91": 0.999848,
               "92": 0.999391, "93": 0.99863, "94": 0.997564, "95": 0.996195, "96": 0.994522, "97": 0.992546,
               "98": 0.990268,
               "99": 0.987688, "100": 0.984808, "101": 0.981627, "102": 0.978148, "103": 0.97437, "104": 0.970296,
               "105": 0.965926, "106": 0.961262, "107": 0.956305, "108": 0.951057, "109": 0.945519, "110": 0.939693,
               "111": 0.93358, "112": 0.927184, "113": 0.920505, "114": 0.913545, "115": 0.906308, "116": 0.898794,
               "117": 0.891007, "118": 0.882948, "119": 0.87462, "120": 0.866025, "121": 0.857167, "122": 0.848048,
               "123": 0.838671, "124": 0.829038, "125": 0.819152, "126": 0.809017, "127": 0.798636, "128": 0.788011,
               "129": 0.777146, "130": 0.766044, "131": 0.75471, "132": 0.743145, "133": 0.731354, "134": 0.71934,
               "135": 0.707107, "136": 0.694658, "137": 0.681998, "138": 0.669131, "139": 0.656059, "140": 0.642788,
               "141": 0.62932, "142": 0.615661, "143": 0.601815, "144": 0.587785, "145": 0.573576, "146": 0.559193,
               "147": 0.544639, "148": 0.529919, "149": 0.515038, "150": 0.5, "151": 0.48481, "152": 0.469472,
               "153": 0.45399,
               "154": 0.438371, "155": 0.422618, "156": 0.406737, "157": 0.390731, "158": 0.374607, "159": 0.358368,
               "160": 0.34202, "161": 0.325568, "162": 0.309017, "163": 0.292372, "164": 0.275637, "165": 0.258819,
               "166": 0.241922, "167": 0.224951, "168": 0.207912, "169": 0.190809, "170": 0.173648, "171": 0.156434,
               "172": 0.139173, "173": 0.121869, "174": 0.104528, "175": 0.087156, "176": 0.069756, "177": 0.052336,
               "178": 0.034899, "179": 0.017452, "180": 0}
        cos = {'0': 1, '1': 0.999848, '2': 0.999391, '3': 0.99863, '4': 0.997564, '5': 0.996195, '6': 0.994522,
               '7': 0.992546,
               '8': 0.990268, '9': 0.987688, '10': 0.984808, '11': 0.981627, '12': 0.978148, '13': 0.97437,
               '14': 0.970296,
               '15': 0.965926, '16': 0.961262, '17': 0.956305, '18': 0.951057, '19': 0.945519, '20': 0.939693,
               '21': 0.93358,
               '22': 0.927184, '23': 0.920505, '24': 0.913545, '25': 0.906308, '26': 0.898794, '27': 0.891007,
               '28': 0.882948,
               '29': 0.87462, '30': 0.866025, '31': 0.857167, '32': 0.848048, '33': 0.838671, '34': 0.829038,
               '35': 0.819152,
               '36': 0.809017, '37': 0.798636, '38': 0.788011, '39': 0.777146, '40': 0.766044, '41': 0.75471,
               '42': 0.743145,
               '43': 0.731354, '44': 0.71934, '45': 0.707107, '46': 0.694658, '47': 0.681998, '48': 0.669131,
               '49': 0.656059,
               '50': 0.642788, '51': 0.62932, '52': 0.615661, '53': 0.601815, '54': 0.587785, '55': 0.573576,
               '56': 0.559193,
               '57': 0.544639, '58': 0.529919, '59': 0.515038, '60': 0.5, '61': 0.48481, '62': 0.469472, '63': 0.45399,
               '64': 0.438371, '65': 0.422618, '66': 0.406737, '67': 0.390731, '68': 0.374607, '69': 0.358368,
               '70': 0.34202, '71': 0.325568, '72': 0.309017, '73': 0.292372, '74': 0.275637, '75': 0.258819,
               '76': 0.241922,
               '77': 0.224951, '78': 0.207912, '79': 0.190809, '80': 0.173648, '81': 0.156434, '82': 0.139173,
               '83': 0.121869,
               '84': 0.104528, '85': 0.087156, '86': 0.069756, '87': 0.052336, '88': 0.034899, '89': 0.017452, '90': 0,
               '91': -0.017452, '92': -0.034899, '93': -0.052336, '94': -0.069756, '95': -0.087156, '96': -0.104528,
               '97': -0.121869, '98': -0.139173, '99': -0.156434, '100': -0.173648, '101': -0.190809, '102': -0.207912,
               '103': -0.224951, '104': -0.241922, '105': -0.258819, '106': -0.275637, '107': -0.292372,
               '108': -0.309017,
               '109': -0.325568, '110': -0.34202, '111': -0.358368, '112': -0.374607, '113': -0.390731,
               '114': -0.406737,
               '115': -0.422618, '116': -0.438371, '117': -0.45399, '118': -0.469472, '119': -0.48481, '120': -0.5,
               '121': -0.515038, '122': -0.529919, '123': -0.544639, '124': -0.559193, '125': -0.573576,
               '126': -0.587785,
               '127': -0.601815, '128': -0.615661, '129': -0.62932, '130': -0.642788, '131': -0.656059,
               '132': -0.669131,
               '133': -0.681998, '134': -0.694658, '135': -0.707107, '136': -0.71934, '137': -0.731354,
               '138': -0.743145,
               '139': -0.75471, '140': -0.766044, '141': -0.777146, '142': -0.788011, '143': -0.798636,
               '144': -0.809017,
               '145': -0.819152, '146': -0.829038, '147': -0.838671, '148': -0.848048, '149': -0.857167,
               '150': -0.866025,
               '151': -0.87462, '152': -0.882948, '153': -0.891007, '154': -0.898794, '155': -0.906308,
               '156': -0.913545,
               '157': -0.920505, '158': -0.927184, '159': -0.93358, '160': -0.939693, '161': -0.945519,
               '162': -0.951057,
               '163': -0.956305, '164': -0.961262, '165': -0.965926, '166': -0.970296, '167': -0.97437,
               '168': -0.978148,
               '169': -0.981627, '170': -0.984808, '171': -0.987688, '172': -0.990268, '173': -0.992546,
               '174': -0.994522,
               '175': -0.996195, '176': -0.997564, '177': -0.99863, '178': -0.999391, '179': -0.999848, '180°': -1}

        #сама программа

        if len(self.formula) < 5:
            self.update_label()
        elif len(self.formula) > 4:

            z = self.formula[4:]
            self.formula = z
            x = int(self.formula)

            if x <= 180:
                if func == "cos":
                    self.formula = str(cos[z])
                if func == 'sin':
                    self.formula = str(sin[z])
            elif x > 180:
                x -= 180
                if func == "cos":
                    self.formula = ('-' + str(cos[str(x)]))
                if func == 'sin':
                    self.formula = ('-' + str(sin[str(x)]))
            self.update_label()

    #интерфейс

    def build(self):
        self.formula = ''
        bl = BoxLayout(orientation="vertical", padding=5)
        gl = GridLayout(cols=4, spacing=2, size_hint = (1, .6 ))

        #мои кнопки where
        self.lbl = Label(text="", font_size = 30, size_hint=(1, .4))
        bl.add_widget( self.lbl )
        #1 str

        gl.add_widget(Button(text="7", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="8", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="9", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="SIN ", on_press = self.choose_operation, background_color = [0, .51, .47],
                             background_normal = ''))

        #2 str

        gl.add_widget(Button(text="4", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="5", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="6", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="COS ", on_press = self.choose_operation, background_color = [0, .51, .47],
                             background_normal = ''))

        #3 str

        gl.add_widget(Button(text="1", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="2", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="3", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="DEL", on_press = self.del_last_symbol, background_color = [0, .86, .8],
                             background_normal = ''))

        #4 str

        gl.add_widget(Widget())
        gl.add_widget(Button(text="0", on_press = self.add_number, background_color = [.42, .42, .42],
                             background_normal = ''))
        gl.add_widget(Button(text="C", on_press = self.del_all, background_color = [0, .86, .8],
                             background_normal = ''))
        gl.add_widget(Button(text="=", on_press = self.Table_res, background_color = [.79, .79, .79],
                             background_normal = ''))

        bl.add_widget(gl)

        return bl

#запуск программы

if __name__ == "__main__":
    TableBradisApp().run()
